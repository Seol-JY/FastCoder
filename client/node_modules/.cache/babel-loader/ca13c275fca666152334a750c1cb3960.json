{"ast":null,"code":"import _regeneratorRuntime from\"/Users/seol-jy/Desktop/Github_Projects/FastCoder/client/.yarn/cache/@babel-runtime-npm-7.18.9-28ca6b5f61-36dd736bab.zip/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/seol-jy/Desktop/Github_Projects/FastCoder/client/.yarn/cache/@babel-runtime-npm-7.18.9-28ca6b5f61-36dd736bab.zip/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/seol-jy/Desktop/Github_Projects/FastCoder/client/.yarn/cache/@babel-runtime-npm-7.18.9-28ca6b5f61-36dd736bab.zip/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import fetcher from'../utils/fetcher';import{useState,useEffect,useCallback}from'react';import{useInView}from\"react-intersection-observer\";import LeaderBoardContents from'./LeaderBoardContents';import{jsx as _jsx}from\"react/jsx-runtime\";export default function LeaderBoard(){var _useInView=useInView(),_useInView2=_slicedToArray(_useInView,2),prev=_useInView2[0],prevInView=_useInView2[1];// 무한 스크롤용 ref - 이전\nvar _useInView3=useInView(),_useInView4=_slicedToArray(_useInView3,2),next=_useInView4[0],nextInView=_useInView4[1];// 무한 스크롤용 ref - 이후\nvar _useState=useState(1),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),items=_useState6[0],setItems=_useState6[1];var getItems=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(page<=1){setPage(1);// page 0이하로 내려가는거 막음\n}setLoading(true);fetcher.load(page).then(function(data){setItems(data);setLoading(false);});case 3:case\"end\":return _context.stop();}}},_callee);})),[page]);useEffect(function(){getItems();},[getItems]);useEffect(function(){if(prevInView&&!loading){setPage(function(prevState){return prevState-1;});}},[prevInView]);useEffect(function(){if(nextInView&&!loading){setPage(function(prevState){return prevState+1;});}},[nextInView]);return/*#__PURE__*/_jsx(\"ul\",{className:\"sidebarsection-rank\",children:items.map(function(s,i){if(i===3){return/*#__PURE__*/_jsx(\"li\",{ref:prev,children:/*#__PURE__*/_jsx(LeaderBoardContents,{s:s})},s._id);}if(i===items.length-1){return/*#__PURE__*/_jsx(\"li\",{ref:next,children:/*#__PURE__*/_jsx(LeaderBoardContents,{s:s})},s._id);}return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(LeaderBoardContents,{s:s})},s._id);})});}","map":{"version":3,"names":["fetcher","useState","useEffect","useCallback","useInView","LeaderBoardContents","LeaderBoard","prev","prevInView","next","nextInView","page","setPage","loading","setLoading","items","setItems","getItems","load","then","data","prevState","map","s","i","_id","length"],"sources":["/Users/seol-jy/Desktop/Github_Projects/FastCoder/client/src/components/LeaderBoard.jsx"],"sourcesContent":["import fetcher from '../utils/fetcher';\nimport { useState, useEffect, useCallback } from 'react'\nimport { useInView } from \"react-intersection-observer\"\nimport LeaderBoardContents from './LeaderBoardContents';\n\nexport default function LeaderBoard() {\n    const [prev, prevInView] = useInView();  // 무한 스크롤용 ref - 이전\n    const [next, nextInView] = useInView();  // 무한 스크롤용 ref - 이후\n    const [page, setPage] = useState(1);\n    const [loading, setLoading] = useState(false);\n    const [items, setItems] = useState([]);\n\n    const getItems = useCallback(async () => {\n      if (page <= 1) {\n        setPage(1);  // page 0이하로 내려가는거 막음\n      } \n      setLoading(true);\n      fetcher.load(page).then((data) => {\n        setItems(data);\n        setLoading(false);\n      });\n    }, [page]);\n\n    useEffect(() => {\n      getItems();\n    }, [getItems]);\n    \n    useEffect(() => {\n      if (prevInView && !loading) {\n        setPage((prevState) => prevState - 1);\n      }\n    }, [prevInView]);\n\n    useEffect(() => {\n      if (nextInView && !loading) {\n        setPage((prevState) => prevState + 1);\n      }\n    }, [nextInView]);\n\n    return (\n      <ul className=\"sidebarsection-rank\">\n          {\n            items.map((s, i) => {\n                if(i===3) {\n                    return<li key={s._id} ref={prev}><LeaderBoardContents s={s}/></li>  \n                }\n                if(i===items.length-1) {\n                    return<li key={s._id} ref={next}><LeaderBoardContents s={s}/></li>  \n                }\n                return <li key={s._id}><LeaderBoardContents s={s}/></li>\n            })\n          }\n      </ul>\n    )\n}"],"mappings":"unBAAA,MAAOA,QAAP,KAAoB,kBAApB,CACA,OAASC,QAAT,CAAmBC,SAAnB,CAA8BC,WAA9B,KAAiD,OAAjD,CACA,OAASC,SAAT,KAA0B,6BAA1B,CACA,MAAOC,oBAAP,KAAgC,uBAAhC,C,2CAEA,cAAe,SAASC,YAAT,EAAuB,CAClC,eAA2BF,SAAS,EAApC,0CAAOG,IAAP,gBAAaC,UAAb,gBAAyC;AACzC,gBAA2BJ,SAAS,EAApC,2CAAOK,IAAP,gBAAaC,UAAb,gBAAyC;AACzC,cAAwBT,QAAQ,CAAC,CAAD,CAAhC,wCAAOU,IAAP,eAAaC,OAAb,eACA,eAA8BX,QAAQ,CAAC,KAAD,CAAtC,yCAAOY,OAAP,eAAgBC,UAAhB,eACA,eAA0Bb,QAAQ,CAAC,EAAD,CAAlC,yCAAOc,KAAP,eAAcC,QAAd,eAEA,GAAMC,SAAQ,CAAGd,WAAW,wEAAC,qIAC3B,GAAIQ,IAAI,EAAI,CAAZ,CAAe,CACbC,OAAO,CAAC,CAAD,CAAP,CAAa;AACd,CACDE,UAAU,CAAC,IAAD,CAAV,CACAd,OAAO,CAACkB,IAAR,CAAaP,IAAb,EAAmBQ,IAAnB,CAAwB,SAACC,IAAD,CAAU,CAChCJ,QAAQ,CAACI,IAAD,CAAR,CACAN,UAAU,CAAC,KAAD,CAAV,CACD,CAHD,EAL2B,sDAAD,GASzB,CAACH,IAAD,CATyB,CAA5B,CAWAT,SAAS,CAAC,UAAM,CACde,QAAQ,GACT,CAFQ,CAEN,CAACA,QAAD,CAFM,CAAT,CAIAf,SAAS,CAAC,UAAM,CACd,GAAIM,UAAU,EAAI,CAACK,OAAnB,CAA4B,CAC1BD,OAAO,CAAC,SAACS,SAAD,QAAeA,UAAS,CAAG,CAA3B,EAAD,CAAP,CACD,CACF,CAJQ,CAIN,CAACb,UAAD,CAJM,CAAT,CAMAN,SAAS,CAAC,UAAM,CACd,GAAIQ,UAAU,EAAI,CAACG,OAAnB,CAA4B,CAC1BD,OAAO,CAAC,SAACS,SAAD,QAAeA,UAAS,CAAG,CAA3B,EAAD,CAAP,CACD,CACF,CAJQ,CAIN,CAACX,UAAD,CAJM,CAAT,CAMA,mBACE,WAAI,SAAS,CAAC,qBAAd,UAEMK,KAAK,CAACO,GAAN,CAAU,SAACC,CAAD,CAAIC,CAAJ,CAAU,CAChB,GAAGA,CAAC,GAAG,CAAP,CAAU,CACN,mBAAM,WAAgB,GAAG,CAAEjB,IAArB,uBAA2B,KAAC,mBAAD,EAAqB,CAAC,CAAEgB,CAAxB,EAA3B,EAASA,CAAC,CAACE,GAAX,CAAN,CACH,CACD,GAAGD,CAAC,GAAGT,KAAK,CAACW,MAAN,CAAa,CAApB,CAAuB,CACnB,mBAAM,WAAgB,GAAG,CAAEjB,IAArB,uBAA2B,KAAC,mBAAD,EAAqB,CAAC,CAAEc,CAAxB,EAA3B,EAASA,CAAC,CAACE,GAAX,CAAN,CACH,CACD,mBAAO,iCAAgB,KAAC,mBAAD,EAAqB,CAAC,CAAEF,CAAxB,EAAhB,EAASA,CAAC,CAACE,GAAX,CAAP,CACH,CARD,CAFN,EADF,CAeH"},"metadata":{},"sourceType":"module"}